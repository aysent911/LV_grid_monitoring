datasource db {
    provider = "postgresql"
    url = env("DATABASE_URL")
}

generator  client {
    provider = "prisma-client-js"
}

model Sensor {
    id          String  @unique @db.VarChar(10)
    type        String          @db.VarChar(10)
    feeder      String          @db.VarChar(10)
    latitude    Float?          @db.DoublePrecision
    longitude   Float?          @db.DoublePrecision
    voltageCurrents      VoltageCurrent[]
    powers               Power[]
    subStationPowers          SubStationPower[]
}

model VoltageCurrent {
    timestamp   DateTime        @db.Timestamptz(3)
    sensor      Sensor          @relation(fields: [sensorId], references: [id])
    sensorId    String          @db.VarChar(10)
    Va          Float           @db.Real
    Vb          Float           @db.Real
    Vc          Float           @db.Real
    Ia          Float           @db.Real
    Ib          Float           @db.Real
    Ic          Float           @db.Real
    faultType   Int?            @db.SmallInt
    
    @@unique([timestamp, sensorId])
}

model Power {
    timestamp   DateTime        @db.Timestamptz(3)
    sensor      Sensor          @relation(fields: [sensorId], references: [id])
    sensorId    String          @db.VarChar(10)
    Pfeed       Float           @db.Real
    Qfeed       Float           @db.Real
    Pagg        Float           @db.Real
    Qagg        Float           @db.Real
    faultType   Int?            @db.SmallInt
    
    @@unique([timestamp, sensorId])
}

model SubStationPower {
    timestamp   DateTime        @db.Timestamptz(3)
    sensorId    String          @db.VarChar(10)
    sensor      Sensor          @relation(fields: [sensorId], references: [id])
    Psub        Float           @db.Real
    Qsub        Float           @db.Real
    @@unique([timestamp, sensorId])
}